<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dl.member.dao.UserBonusMapper">
  <resultMap id="BaseResultMap" type="com.dl.member.model.UserBonus">
    <!--
      WARNING - @mbg.generated
    -->
    <id column="user_bonus_id" jdbcType="INTEGER" property="userBonusId" />
    <result column="user_id" jdbcType="INTEGER" property="userId" />
    <result column="bonus_id" jdbcType="INTEGER" property="bonusId" />
    <result column="bonus_sn" jdbcType="VARCHAR" property="bonusSn" />
    <result column="bonus_price" jdbcType="DECIMAL" property="bonusPrice" />
    <result column="receive_time" jdbcType="INTEGER" property="receiveTime" />
    <result column="used_time" jdbcType="INTEGER" property="usedTime" />
    <result column="start_time" jdbcType="INTEGER" property="startTime" />
    <result column="end_time" jdbcType="INTEGER" property="endTime" />
    <result column="add_time" jdbcType="INTEGER" property="addTime" />
    <result column="order_sn" jdbcType="VARCHAR" property="orderSn" />
    <result column="bonus_status" jdbcType="VARCHAR" property="bonusStatus" />
    <result column="is_delete" jdbcType="INTEGER" property="isDelete" />
    <result column="use_range" jdbcType="INTEGER" property="useRange" />
    <result column="min_goods_amount" jdbcType="DECIMAL" property="minGoodsAmount" />
    
  </resultMap>
  
  <select id="queryUserBonusList" resultType="String" resultMap="BaseResultMap">
	  	SELECT * FROM dl_user_bonus WHERE user_id = #{userId}   
	  	AND  bonus_status = 0 
	  	AND  is_delete = 0  
	  	AND  start_time &lt;= #{curTime} 
	  	AND  end_time &gt;= #{curTime}
	  	AND  user_bonus_id IN
    	<foreach collection="userBonusIds" index="index" item="userBonusId" open="(" separator="," close=")" >
      		#{userBonusId}
    	</foreach>
  </select> 
  
    <select id="queryUserBonusBySelective" parameterType="com.dl.member.model.UserBonus" resultMap="BaseResultMap">
	  	SELECT * FROM dl_user_bonus
		<where>
		  	<if test="userId != null">
		        AND user_id = #{userId}
		    </if>
		    <if test="isDelete != null">
		        AND is_delete = #{isDelete}
		    </if>
		    <if test="bonusStatus != null">
		        AND bonus_status = #{bonusStatus}
		    </if>
		    <if test="bonusId != null">
		        AND bonus_id = #{bonusId}
		    </if>
		    <if test="userBonusId != null">
		        AND user_bonus_id = #{userBonusId}
		    </if>
		    <if test="startTime != null">
		        AND start_time &lt;= #{startTime}
		    </if>
		    <if test="endTime != null">
		        AND end_time &gt;= #{endTime}
		    </if>
	    </where>
	    order by add_time
  </select>
</mapper>